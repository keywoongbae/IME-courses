# 5. 선도,선물 계약 가격의 결정

## 5.1 선물계약과 선도계약

선도계약은 이해관계 맞는 사람끼리 거래하고, 선물계약은 시장에서 이루어진다. 

| 선도계약                                         | 선물계약                                      |
| ------------------------------------------------ | --------------------------------------------- |
| 이해관계가 맞는 2명이서 거래                     | exchange가 중간에서 거래를 이행               |
| 비표준화된 거래                                  | 표준화된 거래                                 |
| Usually 1 specified delivery date                | range of delivery dates                       |
| 만기일에 정산됨                                  | 매일매일 정산됨                               |
| delivery or final cash settlement usually occurs | Contract usually closed out prior to maturity |



## 5.2 공매도

공매도는 판매자가 소유하지 않는 증권이나 상품을 판매하는 것이다. 그러기 때문에 누군가로부터 빌려야한다. 그러므로 다시 갚아야함. 상품 채무자는 채권자에게 배당금이나 다른 이익들을 지불해야 한다. 

> 1. A는 B로부터 주식을 공매도한다.
>
> 2. A는 공매도한 주식을 판다. (+$S$원) 그 시점에 "만기일이 되면 주식을 $F$원에 사겠습니다"라는 선물계약을 체결한다.
>
> 3. <hr>
>
>    만기일이 되고, A는 $F$원에 주식을 구매한다. 그 사이 돈은 불려져있다. ($S e^{rt}-F$)
>
> 4. 그 구매한 주식을 B에게 되돌려준다.



## 5.3 Assumptions and Notation

### 선도 가격의 가정

- 시장 참가자들끼리 거래할 땐 거래비용이 들지 않는다.
- 모든 사람들은 공평하게 똑같은 세김을 지불한다.
- 시장참가자들이 돈을 빌릴 땐 동일한 무위험이자율로 돈을 빌린다.
- 시장참가자들은 차익거래로 이득을 취할 수 있다. 

### Notation

|           |                                           |
| --------- | ----------------------------------------- |
| $t$       | time, 현재 시점은 t=0                     |
| $T$       | 선물, 선도계약의 만기일                   |
| $S (S_t)$ | 기초 자산의 현물가격 (주가)               |
| $K$       | 선물, 선도 계약의 행사가격                |
| $f (f_t)$ | t시점에서 선도계약의 long position의 가치 |
| $F (F_t)$ | t시점에서의 선도가격                      |
| $r$       | 무위험 이자율, 연속복리임                 |



## 5.4 Forward price for an investment asset

만약 $F>Se^{r(T-t)}$인 경우 (short position)

- 선물가격이 적정가격보다 높아졌으므로 높은 가격에 팔 수 있기 때문에 매도 포지션을 취한다.

- $(T-t)$기간 동안 이자율 $r$을 지불하면서 $S$라는 돈을 빌린다. 그리고 자산을 구입한다.

- 이렇게 되면 만기일이 되었을 때 $F-Se^{r(T-t)}$만큼의 이익을 얻는다.

만약 $F<Se^{r(T-t)}$인 경우 (long position)

- 선물가격이 적정가격보다 낮아졌으므로 낮은 가격에 사면 된다. 이런 경우 매수 포지션을 취한다.

- 현물 시장에서 공매도한 주식을 판다. 그리고 판 돈으로 $(T-t)$기간 동안 이자율 $r$을 지불하면서 $S$라는 돈을 빌린다. 그리고 자산을 구입한다.

- 이렇게 되면 만기일이 되었을 때 $F-Se^{r(T-t)}$만큼의 이익을 얻는다.

> #### 연습문제
>
> zero-coupon 채권의 4개월 선도계약을 가정한다. 현재 채권의 가격은 930달러이며, 4개월동안 6%의 무위험 이자율을 가정한다. 이때 적정가격은?
>
> <hr>
>
> $F=930e^{0.06*\frac{4}{12}}=948.79$



#### No income

> #### 연습문제
>
> 주식의 현물가가 40달러라고 하자. 만기는 3개월 후이며, 무위험 이자율은 5% per annum이라고 할 때 선물가격이 43달러일 때와 39달러일 때 arbitrage 전략은?
>
> <hr>
>
> 우선 위의 상황에서 적정가격은 $40*e^{0.05*\frac{3}{12}}=40.5$달러이다.
>
> **(1) 선물가격이 43달러일 때**
>
> 위의 상황은 선물가격이 적정가격 40.5달러보다 비싸므로 비싼 값에 팔기 위해서는 매도 포지션을 취해야 한다.
>
> 1. 주식을 현물가격인 40달러를 주고 구입한다. (-40) 이때 선물계약을 체결한다.
>
> 2. <hr>
>
>    만기일 후, 투자자는 주식을 선물가격인 43달러를 받고 판다. (43-40.5=2.5)
>
> => 결과적으로 2.5달러/계약의 이득을 얻는다.
>
> 
>
> **(2) 선물가격이 39달러일 때**
>
> 위의 상황은 선물가격이 적정가격 39달러보다 싸므로 싼 가격에 사기 위해서는 매수 포지션을 취해야 한다.
>
> 1. 다른 사람으로부터 주식을 공매도한다.
>
> 2. 공매도한 주식을 팔아 돈을 챙긴다 (+40) 이때 선물계약을 체결한다.
>
> 3. <hr>
>
>    만기일 후, 주식을 39달러를 주고 산다. 이 시기가 되면 은행에 있는 돈이 불려져있다. (40.5-39=1.5)
>
> 4. 39달러를 주고 산 주식을 공매도한 사람에게 돌려준다.
>
> => 따라서 결과적으로 이 방법도 1.5달러/계약이라는 이득을 얻게 된다.



### Known Cash income

>#### 연습문제
>
>기초자산은 채권이며, 그 채권의 현물가격은 900달러이다. 만기는 1년이며 6개월 동안의 무위험 이자율은 9% per annum, 1년 동안의 무위험 이자율은 10% per annum이다. 채권은 6개월 그리고 1년마다 40달러라는 쿠폰을 받는다. 이 경우 선물가격이 930달러인 경우와 905달러일 때 arbitrage 전략은?
>
><hr>
>
>> 이때 위 상황에서 주목해야 할 점은 바로 6개월과 1년마다 40달러라는 돈을 지불받는다는 것이다. 이를 통해 2가지의 방법으로 900달러를 빌릴 수 있다. 
>>
>> (1) 1년 만기로 900달러 빌리기
>>
>> 이런 방법으로 빌리게 되면 1년 후에는 $900e^{0.1}=994.653$달러나 갚아야 한다.
>>
>> (2) 일부 금액은 6개월 만기로, 나머지 금액은 1년 만기로 빌리기
>>
>> 어차피 6개월 뒤에 40달러를 받으니, 이 40달러와 퉁치는 정도로 6개월 만기로 빌린다. 
>>
>> $xe^{0.045}=40$을 만족시키는 $x$값은 38.24달러이다. 
>>
>> 따라서 38.24달러는 6개월 만기로 빌리고, 나머지 861.76달러는 1년 만기로 빌린다. 
>>
>> 이런 방법으로 빌리게 되면 총 갚아야 하는 금액은 $40+861.76*e^{0.1}=992.392$달러만 갚으면 된다.
>>
>> 따라서 (2) 방법으로 900달러를 빌리게 되면 2.261달러나 절약하게 된다.
>
>
>
>**(1) 선물가격이 930달러인 경우**
>
>위의 상황은 적정가격보다 비싸므로 비싸게 팔기 위해서는 매도 포지션을 취해야 한다.
>
>1. 주식을 900달러를 주고 산다. 이 때 두 번째 방법을 사용하는 것 잊지 말기. 이 시기에 선물계약을 체결한다. 
>
>2. <hr>
>
>   6개월 후, 투자자는 이 주식(채권)을 가지고 있으므로 40달러를 얻는다. 동시에 40달러를 갚는다.(+40-40)
>
>3. 1년 후, 투자자는 여전히 이 주식을 가지고 있으므로 40달러를 받는다. 그리고 이 주식을 930달러에 판다. 그리고 900달러를 빌렸으니 갚는다. (40+930-952.392=17.608)
>
>=> 따라서 최종적으로 17.608달러의 이익을 얻게 된다.
>
>
>
>**(2) 선물가격이 905달러인 경우**
>
>위의 상황은 적정가격보다 싸므로, 싼 가격에 사기 위해서는 매수 포지션을 취해야 한다.
>
>1. 다른 사람으로부터 채권을 공매도한다. 
>
>2. 그 공매도한 채권을 시장에 판다. 이로 인해 900달러를 얻게 되며, 선물계약을 체결한다. (+900)
>
>3. 매도해서 얻은 900달러 중, 38.24달러는 6개월 만기로 예치하고, 861.76달러는 1년 만기로 예치한다.
>
>4. <hr>
>
>   6개월 후, 40달러를 원래 주인에게 돌려준다.
>
>5. 1년 후, 투자자는 905달러에 주식을 구매하며, 그 돈은 861.76달러에서 불려진 $861.76e^{0.1}=952.392$에서 빼간다. 그 결과 투자자는 47.392달러와 채권을 얻게 된다.
>
>6. 투자자는 원래 주인에게 40달러와 채권을 주며, 최종적으로 7.392달러를 얻게 된다.
>
>=> 따라서 최종적으로 7.392달러의 이익을 얻게 된다.
>
>



따라서 채권의 경우는 다음과 같이 정리할 수 있다. 

| 경우                                     | 계산                |
| ---------------------------------------- | ------------------- |
| 선도가격이 적정가격보다 높은 경우의 이익 | $40+forward-952.39$ |
| 선도가격이 적정가격보다 낮은 경우의 이익 | $952.39-40-forward$ |

따라서 선도가격이 **912.39달러**가 아니게 되면 차익거래 기회가 발생한다.



### Formula

$F=(S-I)e^{r(T-t)}$가 되어야 차익거래가 불가능하다.

>#### 연습문제
>
>$S = 900$, $T-t=1$, r = 9% per six months, 10% per annum 일때
>
>F의 값은? (주식 소유자는 6개월 뒤, 1년 뒤마다 40달러를 받는다)
>
>:arrow_right: $I = 40e^{-0.045}+40e^{0.1} = 74.43$
>
>따라서 $F = (S-I)e^{rt} = (900-74.43)e^{0.1} = 912.395$



>#### 연습문제
>
>$S = 50$, $T-t=1$, $r = 0.08$ (1년), 3개월, 6개월, 9개월마다 배당금 0.75달러씩 지급
>
>적절한 Forward price는?
>
>:arrow_right: $I = 0.75e^{-0.08*3/12}+0.75e^{-0.08*6/12}+0.75e^{-0.08*9/12}=2.16$
>
>$F = (S-I)e^{rt} = (50-2.16)e^{0.08*10/12}=51.14$



### Known Dividend Yield

q : annual rate of dividend yield

만약 자산의 가격이 10달러이고, q=0.05이면, 작은 간격으로 배당금이 연간 0.5달러의 비율로 지급된다.



> #### 연습문제
>
> 6 months forward contract on an asset which provides income equal to 2% once during 6months.
>
> $S = 25$, $T-t = 0.5$, $r = 0.1$, 문제에서 6개월마다 2%씩 지급한다 했으므로 1년에 2번씩 총 4%를 지급한다. 이는 $R_c = m*ln(1+R_m/m)$ 공식을 이용해서 $q = 2*ln(1+0.04/2)=0.0396$이다. 
>
> 따라서 $F = Se^{(r-q)(T-t)} = 25*e^{(0.1-0.0396)*0.5}=25.77$이다.



> #### 연습문제
>
> 2007년 9월 17일 주가지수가 236.25달러이다. 3개월 후 선물 가격이 238.7일때 이자율과 배당률의 차이는 다음과 같다.
>
> $238.7 = 236.25*e^{(r-q)*3/12}$
>
> 따라서 $r-q = 4*ln(238.7/236.25)=0.04126=4.13%$



## 5.7 Valuing Forward Contracts

맨 처음 계약할 때는 가치는 0이다. 그렇지 않으면 arbitrage 기회가 제공될 수 있기 때문이다. 

그러나 시간이 지나면, 선도계약의 가치는 0이 아니다. 현재 행사가격이 $K$라면, 미래에 선물가격은 $F=Ke^{rt}$이어야 한다. 만약 사기로 한 가격 K보다 F가 더 높으면 만기 시점에서의 이익이 발생한다. 

위와 같은 경우 투자자는 $(F-K)$의 이익을 만기 시점에 낼 수 있으며, long forward contract의 현재가치는 

$f = (F-K)e^{-rt}$이다. ($F-K=fe^{rt}$)



|                                                     |                               |
| --------------------------------------------------- | ----------------------------- |
| 만약 중간에 변화가 없이 수익이 없을 때 현재가치 $f$ | $f = (F-K)e^{-rt}=S-Ke^{-rt}$ |
| 중간에 $I$라는 수입이 있는 경우의 선물가치 $f$      | $f = (S-I)-Ke^{-rt}$          |
| 중간에 배당률 $q$를 제공받는 선물가치 $f$           | $f=Se^{-qt}-Ke^{-rt}$         |



### Futures on currencies

>#### 연습문제
>
>달러선물을 하는 계약에서 6개월 만기의 달러 1만불을 선물계약한다고 한다. A는 Long Position을 취하고 B는 Short Position을 취한다. 
>
>달러금리가 연 6%라면, Short Position을 취한 투자자 B가 6개월 후 달러를 인도하기 위해 선물계약에서 필요한 금액은 얼마인가?
>
>
>
>

### Futures on commodities

>#### 연습문제
>
>금선물의 계약 크기는 100온스이고, 현물가격은 450달러/온스이며, 만기는 1년이라고 한다. 무위험 이자율은 7% per annum이며, 금을 저장하는데 드는 비용은 연말에 2달러/온스 씩 년마다 나간다. 위의 선물가격 $F$는 얼마이어야 하는가?
>
><hr>
>
>이 문제는 수입이 있을 때와 완전히 반대의 문제이다. 
>
>수입 $I$가 있는 경우에 선물가격 $F$는 $F=(S-I)e^{rt}$이다. 여기서는 $I$를 빼주었지만 위의 문제에서는 더해주어야 한다.
>
>1. $U=200e^{-0.07}=186.47$
>2. $F=(S+U)e^{0.07}=48463$



